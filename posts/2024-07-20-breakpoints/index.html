<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>No More Breakpoints? - Blog</title><link rel=icon type=image/png href=img/favicon.ico><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="A pre-commit hook ensuring the absence of pdb breakpoints in code"><meta property="og:image" content><meta property="og:url" content="https://kevinkle.in/posts/2024-07-20-breakpoints/"><meta property="og:site_name" content="Blog"><meta property="og:title" content="No More Breakpoints?"><meta property="og:description" content="A pre-commit hook ensuring the absence of pdb breakpoints in code"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-07-20T07:38:07+02:00"><meta property="article:modified_time" content="2024-07-20T07:38:07+02:00"><meta property="article:tag" content="Tech"><meta name=twitter:card content="summary"><meta name=twitter:title content="No More Breakpoints?"><meta name=twitter:description content="A pre-commit hook ensuring the absence of pdb breakpoints in code"><script src=https://kevinkle.in/js/feather.min.js></script><link href=https://kevinkle.in/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://kevinkle.in/css/main.cd139160ccd0ca6bf7d891fb9f590f6c1f70199ff96cd189099b67d9081114e9.css></head><body><div class=content><header><div class=main><a href=https://kevinkle.in/>Blog</a></div><nav><a href=/about>Hello</a>
<a href=/tags>Tags</a>
<a href=/projects>Projects</a></nav></header><main><article><div class=title><h1 class=title>No More Breakpoints?</h1><div class=meta>Posted on Jul 20, 2024</div></div><section class=body><p>I am way past a stage of a crush or merely being in love when it comes to <a href=https://docs.python.org/3/library/pdb.html><code>pdb</code></a>; I&rsquo;d rather call it a deep love.</p><p>Miracurously I have perceived it to be both very flexible and powerful for advanced users as well as very simple and thereby beginner-friendly when catering to rather simple use cases.
What adds to my appreciation for <code>pdb</code> is that - unlike, afaict, most debuggers - it sits rather with the code than the IDE. This agnosticity to IDEs or systems makes it very portable and convenient to use in many different environments, e.g. whenever you only have a terminal access to a machine.</p><p>In case you haven&rsquo;t had the pleasure yet: <code>pdb</code> is a Python debugger. What&rsquo;s somewhat unusual about it when comparing it to e.g. the PyCharm debugger, the <a href=https://code.visualstudio.com/docs/editor/debugging>VSCode debugger</a> but also <a href=https://sourceware.org/gdb/>gdb</a>, is that the debugging metadata becomes part of the code. Hence, instead of defining the debug behaviour via funny dots <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> in an IDE or separate references in a debugging tool, we simply modify our code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> secretmodule
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>my_function</span>(argument1, argument2):
</span></span><span style=display:flex><span>	result_1 <span style=color:#f92672>=</span> secretmodule<span style=color:#f92672>.</span>sorcery(argument1)
</span></span><span style=display:flex><span>	result_2 <span style=color:#f92672>=</span> secretmodule<span style=color:#f92672>.</span>sorcery(argument2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e># What did the sorcery do?</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	breakpoint()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> result_1, result_2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>my_function(<span style=color:#e6db74>&#34;hi&#34;</span>, <span style=color:#e6db74>&#34;ho&#34;</span>)
</span></span></code></pre></div><p>When executing the above script via <code>$ python pdbexample.py</code>, the execution will halt at the
expected line and enter an interactive Python shell:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ python pdbexample.py
</span></span><span style=display:flex><span>&gt; /Users/kevinklein/Code/pdbexample.py<span style=color:#f92672>(</span>11<span style=color:#f92672>)</span>my_function<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>-&gt; <span style=color:#66d9ef>return</span> result_1, result_2
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>Pdb<span style=color:#f92672>)</span> type<span style=color:#f92672>(</span>result_1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>&lt;class <span style=color:#e6db74>&#39;str&#39;</span>&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>Pdb<span style=color:#f92672>)</span> len<span style=color:#f92672>(</span>result_1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>299</span>
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>Pdb<span style=color:#f92672>)</span> print<span style=color:#f92672>(</span>result_1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>hi
</span></span><span style=display:flex><span>      __             __
</span></span><span style=display:flex><span>   .-<span style=color:#e6db74>&#39;.&#39;</span>     .-.     <span style=color:#e6db74>&#39;.&#39;</span>-.
</span></span><span style=display:flex><span> .<span style=color:#e6db74>&#39;.((      ( ^ `&gt;     )).&#39;</span>.
</span></span><span style=display:flex><span>/<span style=color:#e6db74>`</span><span style=color:#e6db74>&#39;- \&#39;</span>._____<span style=color:#ae81ff>\ </span><span style=color:#f92672>(</span>_____.<span style=color:#e6db74>&#39;/ -&#39;</span><span style=color:#e6db74>`</span><span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>|-<span style=color:#e6db74>&#39;&#39;</span><span style=color:#e6db74>`</span>.<span style=color:#e6db74>&#39;------&#39;</span> <span style=color:#e6db74>&#39;------&#39;</span>.<span style=color:#e6db74>`</span><span style=color:#e6db74>&#39;&#39;</span>-|
</span></span><span style=display:flex><span>|.-<span style=color:#e6db74>&#39;`.&#39;</span>.<span style=color:#e6db74>&#39;.`/ | | \`.&#39;</span>.<span style=color:#e6db74>&#39;.`&#39;</span>-.|
</span></span><span style=display:flex><span> <span style=color:#ae81ff>\ </span>.<span style=color:#e6db74>&#39; . /  | | | |  \ . &#39;</span>. /
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;._. :  _|_| |_|_  : ._.&#39;</span>
</span></span><span style=display:flex><span>     <span style=color:#e6db74>`````</span> /T<span style=color:#e6db74>&#34;Y&#34;</span>T<span style=color:#ae81ff>\ </span><span style=color:#e6db74>`````</span>
</span></span><span style=display:flex><span>          / | | | <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>         <span style=color:#e6db74>`</span><span style=color:#e6db74>&#39;`&#39;</span><span style=color:#e6db74>`</span><span style=color:#e6db74>&#39;`&#39;</span><span style=color:#e6db74>`</span><span style=color:#e6db74>&#39;`
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>(Pdb) print(result_2)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>ho
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      __             __
</span></span></span><span style=display:flex><span><span style=color:#e6db74>   .-&#39;</span>.<span style=color:#e6db74>&#39;     .-.     &#39;</span>.<span style=color:#e6db74>&#39;-.
</span></span></span><span style=display:flex><span><span style=color:#e6db74> .&#39;</span>.<span style=color:#f92672>((</span>      <span style=color:#f92672>(</span> ^ <span style=color:#e6db74>`</span>&gt;     <span style=color:#f92672>))</span>.<span style=color:#e6db74>&#39;.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>/`&#39;</span>- <span style=color:#ae81ff>\&#39;</span>._____<span style=color:#ae81ff>\ </span><span style=color:#f92672>(</span>_____.<span style=color:#e6db74>&#39;/ -&#39;</span><span style=color:#e6db74>`</span><span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>|-<span style=color:#e6db74>&#39;&#39;</span><span style=color:#e6db74>`</span>.<span style=color:#e6db74>&#39;------&#39;</span> <span style=color:#e6db74>&#39;------&#39;</span>.<span style=color:#e6db74>`</span><span style=color:#e6db74>&#39;&#39;</span>-|
</span></span><span style=display:flex><span>|.-<span style=color:#e6db74>&#39;`.&#39;</span>.<span style=color:#e6db74>&#39;.`/ | | \`.&#39;</span>.<span style=color:#e6db74>&#39;.`&#39;</span>-.|
</span></span><span style=display:flex><span> <span style=color:#ae81ff>\ </span>.<span style=color:#e6db74>&#39; . /  | | | |  \ . &#39;</span>. /
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;._. :  _|_| |_|_  : ._.&#39;</span>
</span></span><span style=display:flex><span>     <span style=color:#e6db74>`````</span> /T<span style=color:#e6db74>&#34;Y&#34;</span>T<span style=color:#ae81ff>\ </span><span style=color:#e6db74>`````</span>
</span></span><span style=display:flex><span>          / | | | <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>         <span style=color:#e6db74>`</span><span style=color:#e6db74>&#39;`&#39;</span><span style=color:#e6db74>`</span><span style=color:#e6db74>&#39;`&#39;</span><span style=color:#e6db74>`</span><span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#e6db74>`</span>
</span></span></code></pre></div><p>Where I first prompted the type of the result of <code>secretmodule.sorcery</code> applied to a string <code>"hi"</code>, then investigated its length and followlingly printed it.</p><p>Yet, these debugging traces in source code should eventually vanish. And since &lsquo;should&rsquo;s are only &lsquo;should&rsquo;s, this will sometimes fail and lead to a nasty CI unit test failure such as this one:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>events <span style=color:#f92672>=</span> <span style=color:#f92672>[{</span><span style=color:#e6db74>&#39;colorId&#39;</span>: <span style=color:#e6db74>&#39;4&#39;</span>, <span style=color:#e6db74>&#39;created&#39;</span>: <span style=color:#e6db74>&#39;2020-01-01T21:34:53.000Z&#39;</span>, <span style=color:#e6db74>&#39;description&#39;</span>: <span style=color:#e6db74>&#39;14.91 km&#39;</span>, <span style=color:#e6db74>&#39;end&#39;</span>: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;dateTime&#39;</span>: <span style=color:#e6db74>&#39;2020-01-01T10...0Z&#39;</span>, <span style=color:#e6db74>&#39;description&#39;</span>: <span style=color:#e6db74>&#39;14.91 km&#39;</span>, <span style=color:#e6db74>&#39;end&#39;</span>: <span style=color:#f92672>{</span><span style=color:#e6db74>&#39;dateTime&#39;</span>: <span style=color:#e6db74>&#39;2020-01-06T10:00:00+01:00&#39;</span>, <span style=color:#e6db74>&#39;timeZone&#39;</span>: <span style=color:#e6db74>&#39;Europe/Rome&#39;</span><span style=color:#f92672>}</span>, ...<span style=color:#f92672>}</span>, ...<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>sport <span style=color:#f92672>=</span> &lt;Sport.swimming: <span style=color:#e6db74>&#39;swimming&#39;</span>&gt;
</span></span><span style=display:flex><span>    @pytest.mark.parametrize<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;sport&#34;</span>, <span style=color:#f92672>[</span>utils.Sport.swimming, utils.Sport.running<span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>    def test_prune_events_distance<span style=color:#f92672>(</span>events, sport<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>        filter_function <span style=color:#f92672>=</span> cal._get_summary_filter<span style=color:#f92672>(</span>sport<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>&gt;       sport_events <span style=color:#f92672>=</span> list<span style=color:#f92672>(</span>filter<span style=color:#f92672>(</span>filter_function, events<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>tests/test_cal.py:116: 
</span></span><span style=display:flex><span>_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
</span></span><span style=display:flex><span>monitoring/cal.py:49: in summary_filter
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> sport <span style=color:#f92672>==</span> utils.Sport.gym:
</span></span><span style=display:flex><span>/usr/share/miniconda3/envs/monitor/lib/python3.11/bdb.py:90: in trace_dispatch
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> self.dispatch_line<span style=color:#f92672>(</span>frame<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
</span></span><span style=display:flex><span>self <span style=color:#f92672>=</span> &lt;_pytest.debugging.pytestPDB._get_pdb_wrapper_class.&lt;locals&gt;.PytestPdbWrapper object at 0x7f25a459b090&gt;
</span></span><span style=display:flex><span>frame <span style=color:#f92672>=</span> &lt;frame at 0x7f259d9237c0, file <span style=color:#e6db74>&#39;/home/runner/work/life-monitor/life-monitor/monitoring/cal.py&#39;</span>, line 49, code summary_filter&gt;
</span></span><span style=display:flex><span>    def dispatch_line<span style=color:#f92672>(</span>self, frame<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;Invoke user function and return trace function for line event.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        If the debugger stops on the current line, invoke
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        self.user_line(). Raise BdbQuit if self.quitting is set.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        Return self.trace_dispatch to continue tracing in this scope.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self.stop_here<span style=color:#f92672>(</span>frame<span style=color:#f92672>)</span> or self.break_here<span style=color:#f92672>(</span>frame<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>            self.user_line<span style=color:#f92672>(</span>frame<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>&gt;           <span style=color:#66d9ef>if</span> self.quitting: raise BdbQuit
</span></span><span style=display:flex><span>E           bdb.BdbQuit
</span></span><span style=display:flex><span>/usr/share/miniconda3/envs/monitor/lib/python3.11/bdb.py:115: BdbQuit
</span></span></code></pre></div><p>In order to prevent this, I built a simple <a href=https://pre-commit.com/><code>pre-commit</code></a> hook which, for every <code>git</code> commit, ensures that the code is free of <code>breakpoint()</code> statements.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git commit -m <span style=color:#e6db74>&#34;Great work&#34;</span>
</span></span><span style=display:flex><span>black-conda..............................................................Passed
</span></span><span style=display:flex><span>flake8-conda.............................................................Passed
</span></span><span style=display:flex><span>isort-conda..............................................................Passed
</span></span><span style=display:flex><span>no-more-breakpoints-conda................................................Failed
</span></span><span style=display:flex><span>- hook id: no-more-breakpoints-conda
</span></span><span style=display:flex><span>- exit code: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ValueError: Found at least one breakpoint in monitoring/cal.py.
</span></span></code></pre></div><p>You can find information on how to install and use this pre-commit hook <a href=https://github.com/kklein/no-more-breakpoints>here</a>.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Exhibit A: <img src=/imgs/debugger.png alt=image> taken from the <a href=https://www.jetbrains.com/help/pycharm/using-breakpoints.html#set-breakpoints>PyCharm tutorial</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/tech>tech</a></li></ul></nav></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/kklein rel=me title=GitHub><i data-feather=github></i></a>
<a class=border></a><a class=soc href=https://twitter.com/kevkle rel=me title=Twitter><i data-feather=twitter></i></a>
<a class=border></a></div><div class=footer-info>2025 © Kevin Klein |</div></footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-SGRSG6Y0WX"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SGRSG6Y0WX")}</script><script>feather.replace()</script></div></body></html>